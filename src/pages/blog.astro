---
// P√°gina de Blog para SUMAQ AGRO
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

const posts = await getCollection('posts');
const sortedPosts = posts.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
const featuredPost = sortedPosts.find(post => post.data.featured);
const otherPosts = sortedPosts.filter(post => !post.data.featured);
---

<BaseLayout
	title="Blog | SUMAQ AGRO"
	description="Descubre art√≠culos, consejos y noticias sobre agricultura sostenible, productos biol√≥gicos y mejores pr√°cticas agr√≠colas."
	keywords="blog agr√≠cola, consejos agricultura, productos biol√≥gicos, agricultura sostenible, SUMAQ AGRO"
	ogImage="/products/DIATOMAQ.webp"
>
		<!-- Header -->
		<Header />
		
		<!-- Hero Section -->
		<section class="blog-hero">
			<div class="container">
				<div class="hero-content">
					<h1>Blog SUMAQ AGRO</h1>
					<p>Conocimiento y consejos para una agricultura sostenible y eficiente</p>
				</div>
			</div>
		</section>

		<!-- Featured Post -->
		{featuredPost && (
			<section class="featured-post">
				<div class="container">
					<div class="section-header">
						<h2>Art√≠culo Destacado</h2>
						<p>Nuestro contenido m√°s relevante</p>
					</div>
					<article class="featured-article-card">
						{featuredPost.data.heroImage && (
							<div class="featured-image">
								<img src={featuredPost.data.heroImage} alt={featuredPost.data.title} />
							</div>
						)}
						<div class="featured-content">
							<div class="article-meta">
								<span class="article-category">{featuredPost.data.category}</span>
								<span class="article-date">{featuredPost.data.pubDate.toLocaleDateString('es-ES')}</span>
							</div>
							<h3>{featuredPost.data.title}</h3>
							<p>{featuredPost.data.description}</p>
							<div class="article-tags">
								{featuredPost.data.tags?.slice(0, 3).map((tag) => (
									<span class="tag">{tag}</span>
								))}
							</div>
							<a href={`/blog/${featuredPost.slug}`} class="btn btn-primary">Leer Art√≠culo</a>
						</div>
					</article>
				</div>
			</section>
		)}

		<!-- All Posts -->
		<section class="all-posts">
			<div class="container">
				<div class="section-header">
					<h2>Todos los Art√≠culos</h2>
					<p>Explora nuestro contenido sobre agricultura sostenible</p>
				</div>
				<div class="posts-grid">
					{sortedPosts.map((post) => (
						<article class="post-card">
							{post.data.heroImage && (
								<div class="post-image">
									<img src={post.data.heroImage} alt={post.data.title} />
								</div>
							)}
							<div class="post-content">
								<div class="post-meta">
									<span class="post-category">{post.data.category}</span>
									<span class="post-date">{post.data.pubDate.toLocaleDateString('es-ES')}</span>
								</div>
								<h3>{post.data.title}</h3>
								<p>{post.data.description}</p>
								<div class="post-tags">
									{post.data.tags?.slice(0, 2).map((tag) => (
										<span class="tag">{tag}</span>
									))}
								</div>
								<a href={`/blog/${post.slug}`} class="read-more">Leer m√°s ‚Üí</a>
							</div>
						</article>
					))}
				</div>
			</div>
		</section>

		<!-- Related Content -->
		<section class="related-content">
			<div class="container">
				<div class="section-header">
					<h2>¬øTe interesa saber m√°s?</h2>
					<p>Explora nuestros productos y servicios relacionados</p>
				</div>
				<div class="related-grid">
					<div class="related-card">
						<div class="related-icon">üåø</div>
						<h3>Nuestros Productos</h3>
						<p>Descubre toda nuestra l√≠nea de productos biol√≥gicos para una agricultura sostenible</p>
						<a href="/productos" class="btn btn-outline">Ver Cat√°logo</a>
					</div>
					<div class="related-card">
						<div class="related-icon">üìû</div>
						<h3>Asesor√≠a Personalizada</h3>
						<p>¬øTienes dudas sobre Diatomaq? Nuestro equipo est√° listo para ayudarte</p>
						<a href="/contacto" class="btn btn-outline">Contactar</a>
					</div>
					<div class="related-card">
						<div class="related-icon">üè¢</div>
						<h3>Conoce SUMAQ AGRO</h3>
						<p>Descubre nuestra historia y compromiso con la agricultura sostenible</p>
						<a href="/nosotros" class="btn btn-outline">Sobre Nosotros</a>
					</div>
				</div>
			</div>
		</section>

		<!-- Footer -->
		<Footer />
		
		<!-- Smooth Scrolling Script -->
		<script>
			// Smooth scrolling for anchor links
			document.querySelectorAll('a[href^="#"]').forEach(anchor => {
				anchor.addEventListener('click', (e: Event) => {
					e.preventDefault();
					const target = document.querySelector((anchor as HTMLAnchorElement).getAttribute('href') || '');
					if (target) {
						target.scrollIntoView({
							behavior: 'smooth',
							block: 'start'
						});
					}
				});
			});
			
			// Intersection Observer for animations
			const observerOptions = {
				threshold: 0.1,
				rootMargin: '0px 0px -50px 0px'
			};
			
			const observer = new IntersectionObserver((entries) => {
				entries.forEach(entry => {
					if (entry.isIntersecting) {
						entry.target.classList.add('fade-in-up');
					}
				});
			}, observerOptions);
			
			// Observe all sections for animation
			document.querySelectorAll('section').forEach(section => {
				observer.observe(section);
			});
		</script>
</BaseLayout>
